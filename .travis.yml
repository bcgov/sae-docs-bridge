os: linux
dist: trusty
sudo: required
language: node_js
services:
- docker
jobs:
  include:
  - name: SAE Docs Bridge API
    stage: APIs
    language: node_js
    node_js: lts/*
    cache: npm
    before_install:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm ci
      if [ "$TRAVIS_TAG" = "" ]; then npm audit --production; fi
    before_script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      cp config/default.json.template config/default.json
    script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm test
    before_deploy:
    - cd /home/travis/build/bcgov/sae-docs-bridge
    deploy:
      provider: script
      script: bash docker_push sae_docs_bridge || travis_terminate 1
      on:
        all_branches: true
        condition: "$TRAVIS_BRANCH =~ ^master|develop$ || -n $TRAVIS_TAG"
env:
  global:
  - DOCKER_USERNAME=h3brandon
  - QUAYIO_USERNAME=h3brandon
  - secure: jOkX/j0iuqhkdEaHQmy6r2rDtlCjMiBOT73oVzD33cKHE7KLqC5v1xBwZZyM0sriZlceuzxihUGGRIBOQwePXbDaz+EdHjwmXtw80Ch8njPecgJQD2b94np/ml9K7jfPLcqjF80SyL2RerOYWpVJKd0G1+F8Eu1ZdPaK2Cxl/DZmsnWj5U2uuRw6Qm/bAcLVhy+09ju4XPO+zFn1E8p8f5KmHx4RYiv6Nfg8li+74b7W3GrDhZ13Nie0fC2FdpHyQlzwKYn5Se1Pj59yE8E+sAJru3QGV6xKdmzFEYaO0eMTo1+Cgh4pH7aN72t2rG5rozlleHWwSZNjys07SKFZsbKctDytcI7YVQ8Z0qGDUURRO7RyuZBnqbd/6AdGVnuK/le7ZbSUz1f0MqORI85Ezfp5Ok/Y3Go4CitHRdOqeaGxzYQ7qcnxPwYjC5kUzPxmMkCD/8IZspGOytvFKR31eev70yRYv+kmLIRJNV+tksBLetlE2FasFLL0MoKE21I0bOOLMpQKi3EFaY8QzubTclD/69vncGH457S1IShx7URaZ7OhdHNIFkSvvkVTDLZvNdtS9G5naqhym1Vra9jqQMwdYfKSssSQes97WtbI/wIwxl+jmd4a3I7sZzmh6i6UKmjbDtsdvALQt4f+k81KUbwB5t2PdrzaeWKRKR3mR6o=
  - secure: iQKR7q/QPJuI4vjfeguUd4/nEhSmeDwH1/PFG0Ezy1e8xJTFeJ9UXHdn2zZzP7+iR0ohonnVLswcN+/twsxipV6V+Kmd9jTBDDYLZqZdaaiuc78IBiIKlIxHiS+C6OSzeMJg8Y29NMd2EQLezGBPElLyA+sQiu728SEYLQApItlsjrh4yobPFCdcqsBC3VInlg07Ou9mAnmvda6Bm/X+Hmr/BneBSTfwTNmLw8C4hi+5xVvKqy6nXcZTtBqK3CHXjqy5C3TOA+vplqq7d3f1wyVqRpKmVlnd1i4RDXtaIXR4/cFX/c8TkACjn8udJL+sL/trBYjJsZpeyDJ/WEfF0HhpFWWm1KtuL/ziOB5TE0eEHVJA6+woIZqEKjTGJ6iGgAUShpX+rHLox+H0uQGVwV0xbZAy4D5GCa1A5V6kVNdRX3bsBMp7+zC8MW+vaQUi1K89q9gGKYQaT4YuP6DG9Y78cJi/qMakjzAfjmLmNEpiLXhWxUmeAFBqN6ngu5AQ25Ln03G67511Q3CshXxv+93ZhU/6hWHL9aKiLMHR0V97PYUBfh02PAShAVZmccuPqk7T2UVAkgPXAhphKlZKnp8F+oO7/M7TCH4Xz+0JV68sJzTcJfeIBpdvsEua5os0un+pQlvRfkgHiRqgAGwNCQLABMiOLWdkYitL2hsi96g=
