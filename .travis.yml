os: linux
dist: trusty
sudo: required
language: node_js
services:
- docker
jobs:
  include:
  - name: SAE Docs Bridge API
    stage: APIs
    language: node_js
    node_js: lts/*
    cache: npm
    before_install:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm ci
      if [ "$TRAVIS_TAG" = "" ]; then npm audit --production; fi
    before_script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      cp config/default.json.template config/default.json
    script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm test
    before_deploy:
    - cd /home/travis/build/bcgov/sae-docs-bridge
    deploy:
      provider: script
      script: bash docker_push sae_docs_bridge || travis_terminate 1
      on:
        all_branches: true
        condition: "$TRAVIS_BRANCH =~ ^master|develop$ || -n $TRAVIS_TAG"
env:
  global:
  - DOCKER_USERNAME=h3brandon
  - QUAYIO_USERNAME=h3brandon
  - secure: XNrTc9Rvob1Btom0jGEVsyAHGhWBrZ0n23rm9X972C4Zzi2DAg7HQy/u8ziFfemx23LTNsgpYSLtJZVcNhT1xupUwAVlO6N8bpvrDKvlt3QNIh+9kYHoRIS9j38WlH6q1n4tRHMvaReD1XQEnzOKbVl/MWDse4Yby9bNxm7c7oG6pjM7ZT3L+UG4RLbemO2LLEQz18TmMD8VEnmcsTxwPtp9ZeXMg//3u51lBtoGJ6AvIXb36Svmvo8NTwFqvRsJPwh/U5Umw7YnFsUSfPANFmrCESy7fFJm/UmC7fMcBVIUtOqpzpzaUFWdJiwN+OJ8wsC2wCg9GcP6SGTtBACLzKXsuHVUvf4f4u3CJ8jP5c1ZlPbAliYDeWFAL5ySC8wbgVPM+UkP+62ml+DtkLOw5mwFWruME5HefO1cqbU9ITERn4kypowuSsoc4zMj822598cjcHqyzIVwDabsPWC4RhFykAdF0nXsF2VO9dF8IOqc4yeUO+7t4KMOz1tnEIjIbo/JF0O8qLq40llkCRm5fc2i4n8vuwAKyUIf0CLolmt00CfPArDKScMT6HjqiEHCALfWQl7rGRKjNUwLvyEdOFUeXMJILjErydPaUcY8VzLYOaqwpcSE9ai47xN39zSjzkNxo0nGu6hrIIGi5hvzE7CroFATTAI8I78YvntkIbA=
  - secure: E8gw3Uz4r49gOma/AA9RC0ysMg6aB50j8AZOVpMDxSTW8j4uAwnlplRsYILkCxPLMldkxSCTnjxRLroV+EURMHMIDaITIAlsV/YsHSUpWsFyKGXG/nO9TkbhH1gMdybvIaJedYsU4FiW5lBOnRKXxP/7lOvotDILbQZ90pyxZ104bqHrjCaS7cClAkPeVJnJinIqSZtILTBQqBadONUbjlWZwU0IzJJlv9h9wFEsBjLhZOLXpXFHCl6eQF+msK/TOctggsf3NMbotu5yz/H096wyuSDf8veOskcwheo6auxEsfYd/TSxsuz8KIRvv4i3HgFl4iyciyAcX4Z/orfEicQi+9Pvea3SjSGQnC35CAuU2PWiGAK6/56gVYfoS5Y0Gy7n6v+44whzsemrq2QMPa/LovYOLDZhQoi9OvfchMl3Jg82Kbn1muPjQ0+Uj1oRXP4HAV5oOan7UW4gOK1d1s4p4zDnaRWmmNyOr3KBL9dAWxmTUWBLXyCbOZVAkuVmXNiG26Q7L6YBkLReD5HqWhPdR87rlOOOCFtOiiq9mK+wj6FGAwGxJmg26LWgRHXJ7BKln9Pw9k75ljFM263dlnVLeJJXIQ6t2YvruwqRzcVPbV13h9FDzWoVHOdH6vv6gcyWuVHVwPmrV+fmUszPjH+J/n4qXYpDnkQ7Ln5sNtw=
