os: linux
dist: trusty
sudo: required
language: node_js
services:
- docker
jobs:
  include:
  - name: SAE Docs Bridge API
    stage: APIs
    language: node_js
    node_js: lts/*
    cache: npm
    before_install:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm ci
      if [ "$TRAVIS_TAG" = "" ]; then npm audit --production; fi
    before_script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      cp config/default.json.template config/default.json
    script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm test
    before_deploy:
    - cd /home/travis/build/bcgov/sae-docs-bridge
    deploy:
      provider: script
      script: bash docker_push sae_docs_bridge || travis_terminate 1
      on:
        all_branches: true
        condition: "$TRAVIS_BRANCH =~ ^master|develop$ || -n $TRAVIS_TAG"
env:
  global:
  - DOCKER_USERNAME=h3brandon
  - QUAYIO_USERNAME=h3brandon
  - secure: Ia6/DK/ACF3FsW9dkWOu0bZyQF/G2eH82W1fuxNq/lokRqJisjV0im5CiwacOjwsIDHb0ZUAC7s/5o+2oL6NUN7CR1pc2QOuY2zyepPcIh4ny3ac3k3W9FSI5u2fV7NlPXuv5Yc//OiPEXCZdsYUBeildWqTnvDsnaBg5A0IzF7lM4iNHz4BBICkp4jSuhahPYOCTwaNdXrxUkVMO9ZkzSBGq2/p/7qfdnXDVffcSQKXdlIJlrOjyT2VIG3FW5mX7f7J1Frppr2odqbUwK3UXtoHUFY9SgbFADRJApG3hRwfSgOm79L32b5t3CljA0ppxHzDA3wC0bByEfqC+IbfsAOgq1moJwTvNsAgCRd5hXaJtVOHjTOL0JGCUuMXUZ80IPrTe544NqGXgEuJk14wAZ+xtkMAAMzK1WlNBxzF1v1nuxPmCUG3Xk3vgwmgitU7NTZQWQnne2npQMC+FzmfvOdOYe6MzVTXLARDzv2cxv7qCb+z7S7HevRBiTDdJZl1Vf7Wh/cPunuvB1CZbnN8KwHkaSSJNXqftTYHZsBl4+/wY18XgpthP74gZ7XLXXdQPy4dm4/570lmVGTAu+MBQnk/LadhDd+nzaLq4BZnmtoEEs1OUifaWe7ETm5z16N84Nl/6Qt6ZpklASH/+eME5/QNtZzRnOg7rsNzQ9hdifA=
  - secure: Fq3dyoK6VbMNstx8APZtqIuW4rdo+wvLuXQXe6SQXPneerlWqfLXB2mkwUXfzaHaMOydFl76dmNp9hzxvaPy4y8ozhZesg55oL0ne2z5hqfr5Z5fKLcv23GW3RbBmlDEtW3kA4LIy5w2524qFlAD1AkuhSLsjo7s2RX1PDriZ5M8eU7eO3+JSOS3RsDhh8XWT5Kevo5UEPOmYc1y4nmZoyifdtoVpNq0FJswjLhJAsZWSMfrrkBaCc5PxbFhj27MBShMjBuAzNDuKgaQoXSNyRGARJtqwYikp9vrD15H2r3UnQaRVi6zaIQ9CCfWOm1dJeZlsnxaxH8KRs8RHT129kULqUMFtx7d0vQ8Dkwq5bTH7kuyg+FiwXL6XW60FK9D8TUBLoj2a7fLT/o+9HcsvYE/KuBHHjq8uph0cmU76Ilbxuc0EYu2qgSE5YBmdk3cPR7YbjTutmjZFnQzP2RVFPlOAG5veTgHpnBVmPlo8Y1PhY5oyCOEMxjJINVeEk+zD4v7Nnst52MthVAYXy2+DBUCKVhcTK5KnjBpwkzCSPZmzBbjQWAgnRtz4jkLc9/1dPbCiZJb0SuGWxHKO5+BTaPFxaPpWv4eEjfI8Fspi8CUIgZUwHHzgYvNluL5PZRvQpo9bdnZp6pCVReQLCHrqNkx5pIrlyVCikequ91JpDw=
