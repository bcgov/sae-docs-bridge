os: linux
dist: trusty
sudo: required
language: node_js
services:
- docker
jobs:
  include:
  - name: SAE Docs Bridge API
    stage: APIs
    language: node_js
    node_js: lts/*
    cache: npm
    before_install:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm ci
      if [ "$TRAVIS_TAG" = "" ]; then npm audit --production; fi
    before_script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      cp config/default.json.template config/default.json
    script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm test
    before_deploy:
    - cd /home/travis/build/bcgov/sae-docs-bridge
    deploy:
      provider: script
      script: bash docker_push sae_docs_bridge || travis_terminate 1
      on:
        all_branches: true
        condition: "$TRAVIS_BRANCH =~ ^master|develop$ || -n $TRAVIS_TAG"
env:
  global:
  - DOCKER_USERNAME=h3brandon
  - QUAYIO_USERNAME=h3brandon
  - secure: "YmVv1dThbB9BoS4Fg02nk4e3N1eKuFZ/1gxkG4ciBqbpRWjneMCywb2Ndjs8A2PPvqAsS9dAjB6pU63jj/C/l3eg/GAkeBNvCGBymAum7ZY3BsjG1J/lt4S7yyMiHjgrdjlJnumC0qv0q9COT5GGqR40YDHmjIg919OZDgoGTkOtTDdX+POwAIwX0Nu+8EzETzFlgX8DIK8UhuER9gTt52zuejhYuFd7p7oWrIf4KZ4uBOqwuyKwofW9Ak9Gejt1xrffKT7cCwLO6WCz4ZlcR3OBvEUzh2l5TUPCeNqzR68c/IVipC9LSCHI6gXlqtVf6gAPGLb/Uk/dAOfExrT+WtP5mswWhAXwzYWmB38VzFD5DgAl5EF1ySFWz8lRREP+twIOoh7M/ngDafde++QC78eC1Z4hqYIIBKygKfvLrJ3SD5pBdbEGQkX1+sHHlkKEdyrN3xqYZH4I4iCNP4EhWwu+vwAGl6a/pJ2mR+/Bhq9kn8CgKBOjBKHlGkApWG1RO8ebjO1Xr5zJYPuLILu1DPgouf1HFAdiXdvn4M4mxtZyeFlfnIEthbDZCjyr6gPKy6bnzLucGeSwNuuJorVLF31Uute9gJsfpBN+X9dKGnBKD7e6XbGTfGCbcdWcWkm3BiccWViFn/D9f/gCEXAob1ZMLs8khlAtpZdfsvuGmxk="
  - secure: "ndPAf0D4fu1dVQ90pwAJqX2aIDUR5zo92biLzsvohcJ+cHEJlW5w86uhg0QmxpTqMTFkMpxX9fh7C+RuSumWUPp96AxYMhHIRCe0xdyRSjXJ/ayvhj7U1zbHnUIEEoqFUkPMlu8Hw53AMU0IpdWduxMzHXgLJGulFaO/dCw6cqfC6OrScdOgftZJlNFCI3NYPyb4uRPhyijaPs7gm91sE5APuLe0XR3XK0fi1zxjb+1beE6CRF9izSFeWflApZ46TL9YiKgIFe2OWxx7i8fk08tcSLJnpVnHDx+SYgFi40moyNEswo2q6OAF38M5dvvvoQRK2cJuW/K1yrA3oyVxRUaX6mFSGQQ6R8kgr96A76QYzWkKK7cFUMt+S1McPLGYeWQsKKd/MYcQqjNW+1ImsIUnpzezZk9olp68bk6ZUDyRgWHgBqpNhP/f0MVJapGsWRC2vq1+cCMrhEHXxBhaNdmhyxquq3cNqwOhP/HbE++4QweJXhEntgvSG1I1F55fET1tIwABhYq0V0/qfxkifq4WCcj7lIEOjTsu5GLTwlEHiePocc9L6LshE231y8XwJs04Nv6X/GJfpkx9lHH2wgB1O0tSdQ8h6shgQm71g227Vm1ZwPu10ynexKgWcF91D7b5ogKocsje/3PAepWiYZi5xK9qLpQUdRCvsxtqny0="
