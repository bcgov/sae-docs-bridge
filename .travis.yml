os: linux
dist: trusty
sudo: required
language: node_js
services:
- docker
jobs:
  include:
  - name: SAE Docs Bridge API
    stage: APIs
    language: node_js
    node_js: lts/*
    cache: npm
    before_install:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm ci
      if [ "$TRAVIS_TAG" = "" ]; then npm audit --production; fi
    before_script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      cp config/default.json.template config/default.json
    script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm test
    before_deploy:
    - cd /home/travis/build/bcgov/sae-docs-bridge
    deploy:
      provider: script
      script: bash docker_push sae_docs_bridge || travis_terminate 1
      on:
        all_branches: true
        condition: "$TRAVIS_BRANCH =~ ^master|develop$ || -n $TRAVIS_TAG"
env:
  global:
  - secure: cfc1ZNe18u22WXnv9jb4wML+LVllzCNfTD66TMfVn0AhKOqLoiqKCSu2bVaOzXlPT1uhcUCzzTRKh+D+IY/WzDQDoGTXdqUSYpkZCZkCF6SlW5fhSLNvHBSh0x+TeggYb9M7ZYZO2Hj4QByelQasoax8/zhkXW7vWjyWKNfjqV+f17SV9ba6xv9uNLK0ZNUlQECrWb4wPKF3m6dTKGeyKdzwL2lf3t7ciSoij7IxxAUKce6Jc0GXEXGlVQnhXWUIneoDOh1VMToHxYdWiK3gNES0iR6nPp+IpRYUlvNRwz2jlSBPKtJLMuRDTOoJs4vYVJCuOHPmf0mdPZttf5MxEGEhtM8V8H6iuOHBmKpCnk0f8VIWEY8Lyo7neE9TRDQ+QjvYuhp+7hNctAUq5AYaz5wWG/ZvWMENR9jxiezCWvbGm5lDRa5lXet5evlwJ8V9d9IUUhsYI+OnyWcbxqKpqvKKj3TgSB3C0HXz7bOSsz9+xvQNpT1FoItmwilvA+G+Xi2WGB0O+yGAb6EnUX+JdlfzMEJ/JidtekcxKQeabwkSevytLlpqF3ACGAKVFvR+KkxOxLOHQ9bd03oSP6bpvvhJIRlEf70fu3F3aRud7AuOckFwDf70qDcqMyLukUGUG0AKqFpryCN79GLS707yfF+H3s9kfRWx8iANvmpYcC4=
  - secure: IZ/G9X3gQJujkJ8/1ECEgBX8BKPLWXHVvColmqKXhWU0g7Oz6Etr3hOFnr0mA/kgeManO9E4mRYkWKwph6SKjLPLD+3o2SPCVTrVpdsw3h9XKR/LJJq3hAvYmaBX7RyhceVNjMKRyI/ZCBUEpZSj8zFIVXABg51nohLlAPfErDl0OgJ++VuTR578WYNR7l5UjsLyWu7wTH7Jy4jCyiV4BPxXYKFjRTUTMPuyhh5apUJ85Eewbnt4rNZBYQZ2HAcMgnsvV/cYM5ztGpwWjjP7GirVkL6x7zMxgnJdy3XLaFYfQ2g0ETs2sG09YSfUyM1fp96vZu4xrxrdFzdaCiEClRx6Y/18LpocWnxyskMTPNxdToG7LCm1ENmcSymBWKyxeUVCjPIXna1enf+ucNsMatlRa8GNTIv6HccHky6rZBOFOP6X//RAaKJvn5hSytsi7Hwrewvozq3Vhah17soXu69P2939tCYflBj0aUu+fOfeKBuT/2AY0ftWNWa2DEqaLvWmYIqjL+W1ZvroowfVAh0ATLxreChmD95XjClrxbgCMErrs69M0obH7VL8iMXUQvZaod1tWCIixIGLzeLitaGQLBdX0dZ0QVLNTfKEF7BDE0vuPOSZ4q2JnSA4FZ+VL2ilzPK1qKWTrcxOHAUGhIfutl7/ZlM7ZNjtjkFTG/c=
  - secure: qG+tePOq+WSsKyi9T9T/QVhpPZxCQNDwxV0raVooHXIlbm1yuAYp5zMuP9lG4aurDRlkRoPkYfLXXoHaBpi9Xfh/dfTkqfGYXJQrjLi7YO0z/BK/UjHcGp9bkoBNNWVk0FVFDOe+hkyo/FS8EesPTgvIuJrP1edF0lEwcg0OdrViqRfTdDKP3oUDoTSKUt759GKy7XV/ylPX1LK2ZumAKE4vF+aEqRYLbQYluil6O+djIBi/m8R0qbM79vk2sXqVgdF5rsTy35+UdrmbCjR/liYtlkeYRKe0N9C7XE+Y2FqGR00wt8RKCBmSSwDfAEDyFZAOcrV2PcSvWVWFE9QOk56OR2U7wBZEeBqpq7G+OdeEofWJnjliV8lMw8b6auxeG+vWtC7cqXzRwpw90MwbtwutY711ItJOfewuO39IpxzPFMnMUw54kAHiWQGssZAkxO4bpgvEu7Xx3NY1ARY6u35TEtBTIGlLtJtNMbMH25bwZ2xjhw+vplhKtKFoRO2C9rfTYL7ae3UQSSYhoUrBfTexa3WG0KeWNMxHr8q8b97YWXkjnw5Jr01cGo1pzLqu+9bOM6mfkTcXjVQ9c3KCwwyqFnFMgtzPINqGl6V6evLejBPQxxoPAhOzY3CHnEVXEkQqpPnoTVETpGDIaRzi9UGREQB/zXwgHs3EPkV6N8I=
  - secure: eE0zTmhnVMIMPNapx7KeHhzlmZDCmoRXdbsc1zGoUiy3bclGneFqckt69qHH6GqGWUIy1rRv7uJDnUUrdae+SYachQEFSgUIiZ7wzMjTqG/OBX5cQ5UHW2pUy4g/L38Gfjkm+t3me1UDhbC1ZOA90Tf3Pd2mo/ozwDeN7ak6kAkQ6HVUTQEPU6H5LrLKaCVhNN9d9wcZ2vmgosp/PHc2DpddAq/rsg42lZpQEsgJj6djHRdR71lMU1b6cau0nC3mXqlfZ2yRx7753W6Kzi6vDoumFr4wBq/YVDR2pB5Q4P8nfa+rmBbx8LnXwIVwfw86SAHBhSKRDCeRwGIyIMccdbMK3XivFdVzxZsA4n6e93pfH6rPylew53wcchIVeQ+/RunNrxZPvzFCVAWkuEGJyjGDDxepoTJk6d689H1WFFau0nK/UzCu8t+vZO8oA2dMO2KPl74FWS1sKdbVaaPCr0KCjVIJROBeoVMyvdOIIUGLMCEH/2P4A2CghEhjTMziNzYxtv4UqMXMzE7P6gxybS9VPMD0+f7Y/7u3FNArRyK5fmyuLwT0YshvItUtBeyLf2/25jGQoOdojL91teKj8kakvXBfT61zXcx2KS7xcqkLwJz58eRELjF5xqKcL0OwB5SK/6p0xHrluzYNkZl++fjLECtpMiekgw/38e/Mus4=
