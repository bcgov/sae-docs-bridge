os: linux
dist: trusty
sudo: required
language: node_js
services:
- docker
jobs:
  include:
  - name: SAE Docs Bridge API
    stage: APIs
    language: node_js
    node_js: lts/*
    cache: npm
    before_install:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm ci
      if [ "$TRAVIS_TAG" = "" ]; then npm audit --production; fi
    before_script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      cp config/default.json.template config/default.json
    script:
    - |-
      cd /home/travis/build/bcgov/sae-docs-bridge
      npm test
    before_deploy:
    - cd /home/travis/build/bcgov/sae-docs-bridge
    deploy:
      provider: script
      script: bash docker_push sae_docs_bridge || travis_terminate 1
      on:
        all_branches: true
        condition: "$TRAVIS_BRANCH =~ ^master|develop$ || -n $TRAVIS_TAG"
env:
  global:
  - DOCKER_USERNAME=h3brandon
  - QUAYIO_USERNAME=h3brandon
  - secure: "O8IgBB9rqHQyxNdOiCCRGJc5MyiI2rb59g6qe+otCF1UeRK2DXJcbwceU86V1AoYIxCvoZDxozg81BSSfifxYPR5Sf5hgPy6uP4LqTX0VEg3LoZrbmWnf9Y7N7CdfEW5JfssqIWNcFj3cKFdIFz0ZjyrEJeG59fTr+XlVaNByx5QILBzdkVITYaij8pyYoUDgzwyF6P0j2t9vp5OQKiGAq7MU4Wt491y6smoy2wmm+w/bJQbU/nnV+OkdZAp8QLW0sAIGMZXIzvl9n1tCj03Y6t0eNw85C/IVlWNk7HGwupTygzKNFnbzBT3cndkHGw9gnnIx8WuJ7MJwpwuJaMmWKhrPqOIGv8+UyA//492URkjFeUJQPtz7BTEXtQ5NdpNU2pO8LhDCFQdIIBuBlYrllczyZaAzE/L7CZnfnVT47lRQQEFQHrzPg1X9ZXnvSf8Urop5Vh1hHNkvxdJQi2diiUjSflE2rZj0sid5X3s+5gTAqdg/uxW+Zf3CcsVS6cosgy6NU5W9+UtN5GKiQJuXKgOhbVIDKYOaZy0EL6PGluHWODEuNdSAfiZ6uiYQcA4swTImtqS2QgRssYVRb/CiUhArqQH+/co3v48AQOulWa/stZa4ccmVjwwtyHZQM1EYHqU+RMDJ/fKDjcggdmkdizx0ipdyRDVwB7UZsHiM/0="
  - secure: "eaaHAA0LTc6Ygb2cQ8wfnPm92hY7alJ3OYO3bqplML4tH45EByCiSrulBqnir5PVvtpQQ+x6mNZLtuPgBQqO89Ct5E/u/rllSHRvxWhMy40T7tYZS/7j/N9QpzYLuoAbeeox+Z5GxyXRzA5sxusGoVhHfz6qB4InvgD/Q4VQAhm901zR79Qze2aJlDtXkg7iladknjz3s3V4EprRLnUQEAWeZnl5gqAifXP1p3SmJlDw+kW2oQh4ajh81rTUDWD5DsfOb56VEo1cArt/e1G5W2zGw76cNQkNZ+R3ZyKmehqou6fb8LlWKkdFmbpYfDE+B7A7mxBPQSZtaszStjzw9aJkmA1W8TNESZUV2tVNIYTCi2DryfbJR7f4B8/GHwet/X4DphuCxJmS69ghlHJz3qrRyO6+97BovdUjBcfFQI8WauZCzkU7JBA6bxP0cDhkTcBmoLrRiH0u3tjGPmKz/3dxcEajlmyA/XZ4yY9VEskOe7Jb39YdpMTtThRZdExzO4WSagArVwNuxV5eIB3+Y3ONojHr65+4f8Li4AO3NhrAPRMOqMV99Ri9n2MrbOayQjHJmHPuj0DYmG+edl5Wb9bNRrl6wcWapqE59/afGF89YP5HG9fWRg+R1rn2zew5aCfPLV+89kGXJgdUc/2nOLRhP9or784+hjjITw+EsLY="
  
